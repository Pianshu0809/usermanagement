<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
<h2> New User Data Display</h2>

<p *ngIf="loading$ | async" class="text-center text-primary">Loading users...</p>

<form [formGroup]="searchForm" (ngSubmit)="onSearch()">
  <div class="input-group mb-3">
    <input type="text" formControlName="searchQuery" placeholder="Search users..." (input)="onSearch()"/>
    <button class="btn btn-primary" type="submit">Search</button>
    <button mat-raised-button class="btn btn-secondary ms-2" type="button" (click)="openPopup(); $event.stopPropagation()">
      Create New User
    </button>
  </div>
</form>
<div *ngIf="users$ | async as users">
  <table class="table table-bordered">
    <thead >
      <tr>
       <th>Id</th>
      <th>First Name</th>
      <th>Last Name</th>
      <th>Maiden Name</th>
      <th>Age</th>
      <th>Gender</th>
      <th>Email</th>
      <th>Phone</th>
      <th>Username</th>
      <th>Password</th>
      <th>Birthdate</th>
      </tr>
    </thead>
    <tbody>
      <tr *ngFor="let item of users; index as i" (click)="viewDetails(item)" style="cursor: pointer;">
        <td>{{ item.id }}</td>
        <td>{{ item.firstName }}</td>
        <td>{{ item.lastName }}</td>
        <td>{{ item.maidenName }}</td>
        <td>{{ item.age }}</td>
        <td>{{ item.gender }}</td>
        <td>{{ item.email }}</td>
        <td>{{ item.phone }}</td>
        <td>{{ item.username }}</td>
        <td>{{ item.password }}</td>
        <td>{{ item.birthDate }}</td>
      </tr>
    </tbody>
  </table>

 <nav class="mt-3" *ngIf="totalPages$ | async as totalPages">
    <ul
      class="pagination justify-content-center"
      *ngIf="currentPage$ | async as currentPage"
    >
      <li class="page-item" [class.disabled]="currentPage === 1">
        <a class="page-link" (click)="onPageChange(currentPage - 1)">Previous</a>
      </li>

      <li
        class="page-item"
        *ngFor="let page of [].constructor(totalPages); let i = index"
        [class.active]="currentPage === i + 1"
      >
        <a class="page-link" (click)="onPageChange(i + 1)">{{ i + 1 }}</a>
      </li>

      <li class="page-item" [class.disabled]="currentPage === totalPages">
        <a class="page-link" (click)="onPageChange(currentPage + 1)">Next</a>
      </li>
    </ul>
  </nav>
</div>